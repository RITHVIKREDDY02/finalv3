# Complete VPS Deployment Commands
# Run these commands on your VPS to fix the deployment

cd /var/www

# Clean up old installations
pm2 delete tashan-win-vip 2>/dev/null || true
pm2 delete tashan-win-vip-new 2>/dev/null || true
pm2 delete tashan-win-vip-working 2>/dev/null || true
rm -rf tashan-win-vip/ tashan-win-vip-final/ deployment-package/

# Extract the updated deployment package
unzip -o tashan-win-vip-final.zip
cd tashan-win-vip

# Install production dependencies
cd dist
npm install --production
cd ..

# Set environment variables
export NODE_ENV=production
export PORT=5009
mkdir -p logs

# Start the application with updated PM2 config
pm2 start ecosystem.config.cjs --env production

# Verify deployment
pm2 status
pm2 logs tashan-win-vip --lines 10
curl http://localhost:5009/api/games

# If you see JSON response from curl, the deployment is successful!