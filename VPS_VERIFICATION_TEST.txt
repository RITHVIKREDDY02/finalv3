# VPS Admin Panel Verification Test

# Run this on your VPS to verify everything is working
cd /var/www

# Test 1: Verify server is serving the frontend correctly
echo "=== Testing frontend serving ==="
curl -I http://localhost:5009/
curl -I http://localhost:5009/admin

# Test 2: Test all API endpoints
echo -e "\n=== Testing API endpoints ==="

# Register a test user
echo "1. Testing user registration..."
curl -X POST http://localhost:5009/api/register -H "Content-Type: application/json" -d '{"uid":"testuser789"}'

# Login as admin
echo -e "\n2. Testing admin login..."
ADMIN_TOKEN=$(curl -s -X POST http://localhost:5009/api/admin/login -H "Content-Type: application/json" -d '{"password":"Samara@tashan"}' | grep -o '"token":"[^"]*"' | cut -d'"' -f4)
echo "Admin token: $ADMIN_TOKEN"

# Get all users
echo -e "\n3. Testing admin users endpoint..."
curl -H "Authorization: Bearer $ADMIN_TOKEN" http://localhost:5009/api/admin/users

# Test games endpoint
echo -e "\n4. Testing games endpoint..."
curl http://localhost:5009/api/games

# Test frontend files exist
echo -e "\n=== Checking frontend files ==="
ls -la dist/public/
ls -la dist/public/assets/

echo -e "\n=== Server logs ==="
pm2 logs tashan-win-vip --lines 5

echo -e "\n=== Final status ==="
pm2 status

echo -e "\n=== VERIFICATION COMPLETE ==="
echo "If all tests pass, the admin panel should work in your browser."
echo "Try accessing: http://89.116.121.62:5009/admin"
echo "Password: Samara@tashan"